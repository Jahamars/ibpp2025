<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö–æ–º–Ω–∞—Ç–∞: {{ room.name }}</title>
    <link rel="stylesheet" href="{% static 'css/chat-style.css' %}">
</head>
<body>

<div class="chat-layout">

    <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ò–ù–§–û –û –ö–û–ú–ù–ê–¢–ï –ò –£–ß–ê–°–¢–ù–ò–ö–ò -->
    <aside class="sidebar-left">
        <div class="room-info-header">
            <h3>{{ room.name }}</h3>
            <p>#{{ room.get_encryption_algorithm_display }}</p>
        </div>

        <div class="user-list">
            <h4>–£–ß–ê–°–¢–ù–ò–ö–ò ‚Äî {{ participants_count }}</h4> 
            
            <div class="user-item moderator"> <!-- –ü—Ä–∏–º–µ—Ä –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ -->
                <span class="user-avatar"></span>
                <span>{{ request.session.username }} (–í—ã)</span>
                <span class="moderator-badge">üëë</span>
            </div>
            
             <div class="user-item"> <!-- –ü—Ä–∏–º–µ—Ä –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                {% comment %} <span class="user-avatar"></span>
                <span>AnotherUser</span>  {% endcomment %}
            </div>
        </div>
    </aside>

    <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨: –ß–ê–¢ -->
    <main class="chat-main">
        <div class="messages-container" id="messages-container">
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è –∑–¥–µ—Å—å -->
            {% for message in messages %}
                <div class="message">
                    <span class="user-avatar"></span>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="author">{{ message.username }}</span>
                            <span class="timestamp">{{ message.timestamp|date:"d.m.Y H:i" }}</span>
                        </div>
                        <p>{{ message.content }}</p> <!-- TODO: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å! -->
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="message-input-form">
            <form method="POST">
                {% csrf_token %}
                <input type="text" name="content" placeholder="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ #{{ room.name }}" autocomplete="off">
                <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </main>

    <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ù–ê–°–¢–†–û–ô–ö–ò –ò –î–ï–ô–°–¢–í–ò–Ø -->
    <aside class="sidebar-right">
        <div class="settings-panel">
            <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–Ω–∞—Ç—ã</h4>
            <div class="setting-item">
                <label>–ú–∞–∫—Å. —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</label>
                <span>{{ participants_count }} / {{ room.max_users }}</span>
            </div>
            
            <!-- TODO: –°–¥–µ–ª–∞—Ç—å —ç—Ç—É —Ñ–æ—Ä–º—É –≤–∏–¥–∏–º–æ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="moderator-actions">
                <h5>–î–µ–π—Å—Ç–≤–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞</h5>
                <form method="POST" class="setting-item">
                {% csrf_token %}
                <label for="{{ update_form.new_password.id_for_label }}">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</label>
                {{ update_form.new_password }}
                    <button type="submit" class="btn-secondary" style="margin-top: 5px; width: 100%;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                </form>
                <form method="POST" action="{% url 'delete-room' room.name %}"> 
                    {% csrf_token %}
                    <button type="submit" class="btn-danger">–£–¥–∞–ª–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                </form>
            </div>
        </div>

        <div class="actions-panel">
             <form method="POST" action="{% url 'leave-room' room.name %}"> 
                {% csrf_token %}
                <button type="submit" class="btn-secondary">–ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
            </form>
        </div>
    </aside>

</div>

</body>
</html>